(this.webpackJsonpview=this.webpackJsonpview||[]).push([[0],{32:function(e,t){e.exports=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length}},35:function(e,t){t.formatCurrency=function(e){return Number(e.replace(/[^0-9.-]+/g,""))},t.numToCurrency=function(e){var t=e.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",");return"$".concat(t)}},37:function(e,t,a){e.exports=a(68)},42:function(e,t,a){},68:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(31),i=a.n(s),c=(a(42),a(10)),u=a(2),o=a(4),l=a(33),m=a(19),d=function(e,t){return Object(m.a)(Object(m.a)({},e),t)},p=function(e,t){return d(e,t.payload)},b=a(32),g=a.n(b),h=function(e,t){return d(e.auth,{isAuth:!g()(t.payload),user:t.payload})},f=function(e,t){return d(e,t.payload)},E=Object(l.a)({err:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return p(e,t);case"CLEAR_ERRORS":return{};default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return h(e,t);default:return e}},acc:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TRANS_DETAILS":return f(e,t);case"CLEAR_TRANS_DETAILS":return{};default:return e}}}),y={acc:{},err:{},auth:{user:null,isAuth:!1}},w=Object(r.createContext)(),v=function(e){var t=e.children,a=Object(r.useReducer)(E,y),s=Object(o.a)(a,2),i=s[0],c=s[1];return n.a.createElement(w.Provider,{value:{state:i,dispatch:c}},t)},S=a(35),R=a(1),O=a.n(R),N=a(5),j=a(11),_=a.n(j),C=a(14),k=a.n(C),x=function(e){e?_.a.defaults.headers.common.Authorization="Bearer ".concat(e):delete _.a.defaults.headers.common.Authorization},P=function(e){return localStorage.setItem("jwtToken",e),x(e),k()(e)},T=function(){var e=Object(N.a)(O.a.mark((function e(t,a){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.a.post("/api/v1/users/register",t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),a({type:"GET_ERRORS",payload:e.t0.response.data});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,a){return e.apply(this,arguments)}}(),A=function(){var e=Object(N.a)(O.a.mark((function e(t,a){var r,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.a.post("/api/v1/users/login",t);case 3:r=e.sent,n=P(r.data.token),a({type:"SET_CURRENT_USER",payload:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a({type:"GET_ERRORS",payload:e.t0.response.data});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}(),L=Object(u.f)((function(e){var t,a=Object(r.useContext)(w).dispatch;return"/account"===e.history.location.pathname&&(t=n.a.createElement("h2",{to:"/",onClick:function(){return function(e){localStorage.removeItem("jwtToken"),x(!1),e({type:"SET_CURRENT_USER",payload:{}})}(a)},className:"card__link heading-secondary heading-active"},"Logout")),n.a.createElement("div",{className:"card ta-center"},t,e.children)})),B=function(e){var t,a;if(e.entries){var r=e.entries.map((function(e,t){return n.a.createElement("li",{key:t},e)}));t=n.a.createElement("ul",null,r)}return e.close&&(a=n.a.createElement("a",{className:"alert__close",onClick:e.close},"Dismiss")),n.a.createElement("div",{className:"alert alert--".concat(e.type)},e.entries?t:e.children,a)},D=function(e){return n.a.createElement("div",{className:"form__group ".concat(e.groupClass)},n.a.createElement("input",{type:e.type,name:e.name,id:e.id,className:"form__input ".concat(e.inputClass),placeholder:e.placeholder,minLength:e.minLength,value:e.value,required:e.required,onChange:e.onChange,onFocus:e.onFocus}),e.label?n.a.createElement("label",{htmlFor:e.htmlFor,className:e.err?"form__label fc-danger":"form__label"},e.err?e.err:e.label):null)},F=function(){var e=Object(N.a)(O.a.mark((function e(t,a){var r,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.a.post("/api/v1/transactions/deposit",t);case 3:r=e.sent,n=P(r.data.token),a({type:"SET_CURRENT_USER",payload:n}),a({type:"SET_TRANS_DETAILS",payload:r.data.transDetails}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),a({type:"GET_ERRORS",payload:e.t0.response.data});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,a){return e.apply(this,arguments)}}(),U=function(){var e=Object(N.a)(O.a.mark((function e(t,a){var r,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.a.post("/api/v1/transactions/withdraw",t);case 3:r=e.sent,n=P(r.data.token),a({type:"SET_CURRENT_USER",payload:n}),a({type:"SET_TRANS_DETAILS",payload:r.data.transDetails}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),a({type:"GET_ERRORS",payload:e.t0.response.data});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,a){return e.apply(this,arguments)}}(),I={deposit:"",submitted:!1,submitting:!1,submitSuccess:!1,disableSubmitButton:!1},q=function(e,t){switch(t.type){case"setDeposit":return d(e,{deposit:t.payload});case"isSubmitting":return d(e,{submitted:!1,submitting:!0,submitSuccess:!1,disableSubmitButton:!0});case"submitted":return d(e,{submitted:!0,submitting:!1,disableSubmitButton:!1});case"submitSuccess":return d(e,{deposit:"",submitSuccess:!0});default:return e}},W=function(){var e=Object(N.a)(O.a.mark((function e(t,a,r,n,s){var i,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n({type:"isSubmitting"}),Object.keys(r.err).length&&s({type:"CLEAR_ERRORS"}),i=new Date,c={time:i.toISOString(),amount:Number(a.deposit)},e.next=7,F(c,s);case 7:n({type:"submitted"});case 8:case"end":return e.stop()}}),e)})));return function(t,a,r,n,s){return e.apply(this,arguments)}}(),G=function(e){var t=Object(r.useReducer)(q,I),a=Object(o.a)(t,2),s=a[0],i=a[1],c=Object(r.useContext)(w),u=c.state,l=c.dispatch;return Object(r.useEffect)((function(){s.submitted&&!Object.keys(u.err).length&&i({type:"submitSuccess"})}),[s.submitted,u.err]),n.a.createElement(n.a.Fragment,null,Object.values(u.acc).length?n.a.createElement(B,{type:"success",entries:Object.values(u.acc),close:function(){return l({type:"CLEAR_TRANS_DETAILS"})}}):null,Object.values(u.err).length?n.a.createElement(B,{type:"error",entries:Object.values(u.err),close:function(){return l({type:"CLEAR_ERRORS"})}}):null,n.a.createElement("a",{className:"heading-tertiary ma-bt-md",onClick:e.redirect},"Back to account options"),n.a.createElement("form",{className:"form",onSubmit:function(e){return W(e,s,u,i,l)}},n.a.createElement("h2",{className:"heading-secondary ma-bt-sm"},"Choose an amount to deposit"),n.a.createElement(D,{type:"number",name:"deposit",id:"deposit",placeholder:"Deposit amount",value:s.deposit,required:!0,onChange:function(e){return i({type:"setDeposit",payload:e.target.value})},htmlFor:"deposit",label:"Deposit amount",err:u.err.amount}),n.a.createElement("div",{className:"form__group"},n.a.createElement("button",{type:"submit",className:"btn btn--primary",disabled:s.disableSubmitButton},s.submitting?"Submitting deposit...":"Submit deposit"))))},M={withdraw:"",submitted:!1,submitting:!1,submitSuccess:!1,disableSubmitButton:!1},z=function(e,t){switch(t.type){case"setWithdrawal":return d(e,{withdraw:t.payload});case"isSubmitting":return d(e,{submitted:!1,submitting:!0,submitSuccess:!1,disableSubmitButton:!0});case"submitted":return d(e,{submitted:!0,submitting:!1,disableSubmitButton:!1});case"submitSuccess":return d(e,{withdraw:"",submitSuccess:!0});default:return e}},J=function(){var e=Object(N.a)(O.a.mark((function e(t,a,r,n,s){var i,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n({type:"isSubmitting"}),Object.keys(r.err).length&&s({type:"CLEAR_ERRORS"}),i=new Date,c={time:i.toISOString(),amount:Number(a.withdraw)},e.next=7,U(c,s);case 7:n({type:"submitted"});case 8:case"end":return e.stop()}}),e)})));return function(t,a,r,n,s){return e.apply(this,arguments)}}(),$=function(e){var t=Object(r.useReducer)(z,M),a=Object(o.a)(t,2),s=a[0],i=a[1],c=Object(r.useContext)(w),u=c.state,l=c.dispatch;return Object(r.useEffect)((function(){s.submitted&&!Object.keys(u.err).length&&i({type:"submitSuccess"})}),[s.submitted,u.err]),n.a.createElement(n.a.Fragment,null,Object.values(u.acc).length?n.a.createElement(B,{type:"success",entries:Object.values(u.acc),close:function(){return l({type:"CLEAR_TRANS_DETAILS"})}}):null,Object.values(u.err).length?n.a.createElement(B,{type:"error",entries:Object.values(u.err),close:function(){return l({type:"CLEAR_ERRORS"})}}):null,n.a.createElement("a",{className:"heading-tertiary ma-bt-md",onClick:e.redirect},"Back to account options"),n.a.createElement("form",{className:"form",onSubmit:function(e){return J(e,s,u,i,l)}},n.a.createElement("h2",{className:"heading-secondary ma-bt-sm"},"Choose an amount to withdraw"),n.a.createElement(D,{type:"number",name:"withdraw",id:"withdraw",placeholder:"Withdraw amount",label:"Withdraw amount",value:s.withdraw,required:!0,onChange:function(e){return i({type:"setWithdrawal",payload:e.target.value})},htmlFor:"withdraw",err:u.err.amount}),n.a.createElement("div",{className:"form__group"},n.a.createElement("button",{type:"submit",className:"btn btn--primary",disabled:s.disableSubmitButton},s.submitting?"Submitting withdrawal...":"Submit withdrawal"))))},H=Object(u.f)((function(e){var t,a,s=Object(r.useState)(""),i=Object(o.a)(s,2),c=i[0],u=i[1],l=Object(r.useContext)(w).state.auth,m=l.isAuth,d=l.user;return d&&m&&(a=Object(S.numToCurrency)(d.account.total)),Object(r.useEffect)((function(){m||e.history.push("/")}),[m]),c?"deposit"===c?t=n.a.createElement(G,{redirect:function(){return u("")}}):"withdraw"===c&&(t=n.a.createElement($,{redirect:function(){return u("")}})):t=n.a.createElement("ul",{className:"account__links"},n.a.createElement("li",{className:"account__link text-primary heading-active fw-medium",onClick:function(){return u("deposit")}},"Make a deposit"),n.a.createElement("li",{className:"account__link text-primary heading-active fw-medium",onClick:function(){return u("withdraw")}},"Make a withdrawal")),n.a.createElement(L,null,n.a.createElement("header",{className:"ma-bt-xlg"},n.a.createElement("h1",{className:"heading-primary heading-primary--spans"},n.a.createElement("span",null,"Account Total"),n.a.createElement("span",null,a))),n.a.createElement("ul",{className:"account__content"},t))})),K=Object(u.f)((function(e){var t=Object(r.useContext)(w).state;return Object(r.useEffect)((function(){t.auth.isAuth&&e.history.push("/account")}),[t.auth.isAuth]),n.a.createElement(L,null,n.a.createElement("header",{className:"ma-bt-xlg"},n.a.createElement("h1",{className:"heading-primary ma-bt-sm"},"KOHO Assignment Application"),n.a.createElement("h2",{className:"heading-secondary"},"Create an account, make deposits, and withdrawals")),n.a.createElement("main",null,n.a.createElement("h3",{className:"heading-secondary ma-bt-md"},"Login or register to get started"),n.a.createElement("div",{className:"landing__authenticate-links"},n.a.createElement(c.b,{to:"/authenticate/login",className:"heading-tertiary"},"Login"),n.a.createElement(c.b,{to:"/authenticate/register",className:"heading-tertiary"},"Register"))))})),Q={loginEmail:"",loginPassword:"",submitting:!1,submitted:!1,disableSubmitButton:!1},V=function(e,t){switch(t.type){case"setEmail":return d(e,{loginEmail:t.payload});case"setPassword":return d(e,{loginPassword:t.payload});case"isSubmitting":return d(e,{submitting:!0,disableSubmitButton:!0});case"submitted":return d(e,{submitting:!1,disableSubmitButton:!1});default:return e}},X=function(){var e=Object(N.a)(O.a.mark((function e(t,a,r,n,s){var i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n({type:"isSubmitting"}),Object.keys(r.err).length&&s({type:"CLEAR_ERRORS"}),i={loginEmail:a.loginEmail,loginPassword:a.loginPassword},e.next=6,A(i,s);case 6:case"end":return e.stop()}}),e)})));return function(t,a,r,n,s){return e.apply(this,arguments)}}(),Y=function(){var e=Object(r.useReducer)(V,Q),t=Object(o.a)(e,2),a=t[0],s=t[1],i=Object(r.useContext)(w),c=i.state,u=i.dispatch;return Object(r.useEffect)((function(){a.submitting&&Object.keys(c.err).length&&s({type:"submitted"})}),[a.submitting,c.err]),n.a.createElement("form",{className:"form",onSubmit:function(e){return X(e,a,c,s,u)}},n.a.createElement("h2",{className:"heading-primary ma-bt-sm"},"Login"),n.a.createElement(D,{type:"email",name:"loginEmail",id:"email",placeholder:"Email address",value:a.loginEmail,required:!0,onChange:function(e){return s({type:"setEmail",payload:e.target.value})},htmlFor:"loginEmail",label:"Email address",err:c.err.loginEmail}),n.a.createElement(D,{type:"password",name:"loginPassword",id:"loginPassword",placeholder:"Password",value:a.loginPassword,required:!0,onChange:function(e){return s({type:"setPassword",payload:e.target.value})},htmlFor:"loginPassword",label:"Password",err:c.err.loginPassword}),n.a.createElement("div",{className:"form__group ma-bt-md"},n.a.createElement("button",{type:"submit",className:"btn btn--primary",disabled:a.disableSubmitButton},a.submitting?"Logging In...":"Login")))},Z={registerEmail:"",registerName:"",registerPassword:"",registerPasswordConfirm:"",submitted:!1,submitting:!1,disableSubmitButton:!1,newRegister:!1},ee=function(e,t){switch(t.type){case"setEmail":return d(e,{registerEmail:t.payload});case"setName":return d(e,{registerName:t.payload});case"setPassword":return d(e,{registerPassword:t.payload});case"setPasswordConfirm":return d(e,{registerPasswordConfirm:t.payload});case"isSubmitting":return d(e,{submitted:!1,submitting:!0,disableSubmitButton:!0});case"submitted":return d(e,{submitted:!0,submitting:!1,disableSubmitButton:!1});case"submitSuccess":return d(e,{registerEmail:"",registerName:"",registerPassword:"",registerPasswordConfirm:"",newRegister:!0});default:return e}},te=function(){var e=Object(N.a)(O.a.mark((function e(t,a,r,n,s){var i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n({type:"isSubmitting"}),Object.keys(r.err).length&&s({type:"CLEAR_ERRORS"}),i={registerEmail:a.registerEmail,registerName:a.registerName,registerPassword:a.registerPassword,registerPasswordConfirm:a.registerPasswordConfirm},e.next=6,T(i,s);case 6:n({type:"submitted"});case 7:case"end":return e.stop()}}),e)})));return function(t,a,r,n,s){return e.apply(this,arguments)}}(),ae=function(){var e=Object(r.useReducer)(ee,Z),t=Object(o.a)(e,2),a=t[0],s=t[1],i=Object(r.useContext)(w),c=i.state,u=i.dispatch;return Object(r.useEffect)((function(){a.submitted&&!Object.keys(c.err).length&&s({type:"submitSuccess"})}),[a.submitted,c.err]),n.a.createElement("form",{className:"form",onSubmit:function(e){return te(e,a,c,s,u)}},n.a.createElement("h2",{className:"heading-primary ma-bt-sm"},a.newRegister?"Register Successful!":"Register"),n.a.createElement(D,{type:"email",name:"registerEmail",id:"registerEmail",placeholder:"Email address",value:a.registerEmail,required:!0,onChange:function(e){return s({type:"setEmail",payload:e.target.value})},htmlFor:"registerEmail",label:"Email address",err:c.err.registerEmail}),n.a.createElement(D,{type:"text",name:"registerName",id:"registerName",placeholder:"Full name",value:a.registerName,required:!0,onChange:function(e){return s({type:"setName",payload:e.target.value})},htmlFor:"registerName",label:"Full name",err:c.err.registerName}),n.a.createElement(D,{type:"password",name:"registerPassword",id:"registerPassword",placeholder:"Password",value:a.registerPassword,required:!0,onChange:function(e){return s({type:"setPassword",payload:e.target.value})},htmlFor:"registerPassword",label:"Password",err:c.err.registerPassword}),n.a.createElement(D,{type:"password",name:"registerPasswordConfirm",id:"registerPasswordConfirm",placeholder:"Confirm Password",value:a.registerPasswordConfirm,required:!0,onChange:function(e){return s({type:"setPasswordConfirm",payload:e.target.value})},htmlFor:"registerPasswordConfirm",label:"Confirm Password",err:c.err.registerPasswordConfirm}),n.a.createElement("div",{className:"form__group ma-bt-md"},a.newRegister?n.a.createElement("p",{className:"heading-secondary"},"Thanks for registering! Please log in to get started!"):n.a.createElement("button",{type:"submit",className:"btn btn--primary",disabled:a.disableSubmitButton},a.submitting?"Registering...":"Register")))},re=Object(u.f)((function(e){var t=Object(r.useState)(""),a=Object(o.a)(t,2),s=a[0],i=a[1],u=Object(r.useContext)(w).state;return Object(r.useEffect)((function(){u.auth.isAuth&&e.history.push("/account"),"login"===e.match.params.type?i("login"):"register"===e.match.params.type&&i("register")}),[e.match.params.type,u.auth.isAuth]),n.a.createElement(L,null,n.a.createElement(n.a.Fragment,null,"login"===s?n.a.createElement(Y,null):n.a.createElement(ae,{setPage:function(){return i("login")}}),"login"===s?n.a.createElement(n.a.Fragment,null,n.a.createElement("h3",{className:"heading-tertiary ma-bt-sm"},"Need to register?"),n.a.createElement(c.b,{className:"text-primary",to:"/authenticate/register"},"Register")):n.a.createElement(n.a.Fragment,null,n.a.createElement("h3",{className:"heading-tertiary ma-bt-sm"},"Already registered?"),n.a.createElement(c.b,{className:"text-primary",to:"/authenticate/login"},"Login"))))}));var ne=function(){var e=Object(r.useContext)(w).dispatch;return Object(r.useEffect)((function(){if(localStorage.jwtToken){x(localStorage.jwtToken);var t=k()(localStorage.jwtToken),a=Date.now()/1e3;t.exp<a?(e({type:"SET_CURRENT_USER",payload:{}}),window.location.href="/"):e({type:"SET_CURRENT_USER",payload:t})}}),[]),n.a.createElement(c.a,null,n.a.createElement(u.c,null,n.a.createElement(u.a,{exact:!0,path:"/",component:K}),n.a.createElement(u.a,{exact:!0,path:"/account",component:H}),n.a.createElement(u.a,{exact:!0,path:"/authenticate/:type",component:re})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(v,null,n.a.createElement(ne,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.6eaf24ea.chunk.js.map